function dJdr = computeDJdr(d2, r)
%UNTITLED7 Summary of this function goes here
%   Detailed explanation goes here
s0 = d2(1);
s1 = d2(2);
s2 = d2(3);
s3 = d2(4);
x0 = r(1, 2);
x1 = r(1, 3);
x2 = r(2, 3);
x3 = r(1, 4);
x4 = r(2, 4);
x5 = r(3, 4);


dJdr = 2*diag(sqrt(d2))*[(s1 - 2*s0 + s2)*(2*x1*x4^2 - 2*x2*x3*x4 + 2*x1*x5^2) - 2*x2^2*x3^3 - 2*x1^3*x5^2 - 2*x0*(x1^2*x2*x4 - 2*x1^2*x4^2 - 2*x1^2*x5^2 + 2*x1*x2*x3*x4 - 2*x0*x1*x2*x4 + 2*x0*x1*x4^2 + 2*x0*x1*x5^2 + x2^3*x4 - 2*x2^2*x3^2 + 2*x0*x2^2*x3 - 2*x2^2*x4^2 - x2^2*x5^2 + x2*x3^2*x4 - 2*x0*x2*x3*x4 + x2*x4^3 + x2*x4*x5^2) - 2*x1^3*x4^2 - 2*x0*x2*x4^3 - 2*x0*x2^3*x4 + 2*x1*x2*x4^3 + 2*x2^3*x3*x4 + 4*x0*x1^2*x4^2 + 4*x0*x2^2*x3^2 - 2*x0^2*x1*x4^2 - 2*x0^2*x2^2*x3 + 4*x0*x1^2*x5^2 + 4*x0*x2^2*x4^2 - 2*x0^2*x1*x5^2 + 2*x0*x2^2*x5^2 - 2*x1*x2^2*x4^2 - 2*x1*x2^2*x5^2 - 2*x2^2*x3*x4^2 - 2*x2^2*x3*x5^2 + 2*x0*x2^2*(2*s0 - 2*s3) + 2*x0*(2*s0 - 2*s2)*(x4^2 + x5^2) - 2*x2*(x1*x4 - x2*x3)*(s1 - 2*s0 + s3) - 2*x0*x1^2*x2*x4 + 2*x0^2*x1*x2*x4 - 2*x0*x2*x3^2*x4 + 2*x0^2*x2*x3*x4 + 2*x1*x2*x3^2*x4 + 2*x1^2*x2*x3*x4 - 2*x0*x2*x4*x5^2 + 2*x1*x2*x4*x5^2 + 4*x0*x2*x4*(s2 - 2*s0 + s3) - 4*x0*x1*x2*x3*x4, (2*s0 - 2*s1)*(2*x1*x4^2 - 2*x2*x3*x4 + 2*x1*x5^2) - 2*x0*(- x0^2*x2*x4 + x0^2*x4^2 + x0^2*x5^2 + 2*x0*x1*x2*x4 - 4*x0*x1*x4^2 - 4*x0*x1*x5^2 + 2*x0*x2*x3*x4 + 3*x1^2*x4^2 + 3*x1^2*x5^2 - 2*x1*x2*x3*x4 + x2^2*x4^2 + x2^2*x5^2 - x2*x3^2*x4 - x2*x4^3 - x2*x4*x5^2) + 2*x0*(x4^2 + x5^2)*(s1 - 2*s0 + s2) - 2*x0*x2*x4*(s1 - 2*s0 + s3), (2*s0 - 2*s1)*(2*x2*x3^2 - 2*x1*x4*x3 + 2*x2*x5^2) - (2*x0*(x1*x4 - x2*x3) - 2*x0*x2*x3)*(s1 - 2*s0 + s3) - 2*x0*(- x0^2*x1*x4 + 2*x0^2*x2*x3 - x0^2*x3*x4 + x0*x1^2*x4 + 2*x0*x1*x3*x4 + 3*x0*x2^2*x4 - 4*x0*x2*x3^2 - 4*x0*x2*x4^2 - 2*x0*x2*x5^2 + x0*x3^2*x4 + x0*x4^3 + x0*x4*x5^2 - x1^2*x3*x4 + 2*x1*x2*x4^2 + 2*x1*x2*x5^2 - x1*x3^2*x4 - x1*x4^3 - x1*x4*x5^2 - 3*x2^2*x3*x4 + 2*x2*x3^3 + 2*x2*x3*x4^2 + 2*x2*x3*x5^2) + 2*x0^2*x2*(2*s0 - 2*s3) + 2*x0^2*x4*(s2 - 2*s0 + s3) - 2*x0*x3*x4*(s1 - 2*s0 + s2), (2*s0 - 2*s1)*(2*x3*x2^2 - 2*x1*x4*x2) - 2*x0*(x0^2*x2^2 - x0^2*x2*x4 + 2*x0*x1*x2*x4 - 4*x0*x2^2*x3 + 2*x0*x2*x3*x4 - x1^2*x2*x4 - 2*x1*x2*x3*x4 - x2^3*x4 + 3*x2^2*x3^2 + x2^2*x4^2 + x2^2*x5^2) + 2*x0*x2^2*(s1 - 2*s0 + s3) - 2*x0*x2*x4*(s1 - 2*s0 + s2), (2*s0 - 2*s1)*(2*x4*x1^2 - 2*x2*x3*x1) - 2*x0*(- x0^2*x1*x2 + 2*x0^2*x1*x4 - x0^2*x2*x3 + x0*x1^2*x2 - 4*x0*x1^2*x4 + 2*x0*x1*x2*x3 + x0*x2^3 - 4*x0*x2^2*x4 + x0*x2*x3^2 + 3*x0*x2*x4^2 + x0*x2*x5^2 + 2*x1^3*x4 - x1^2*x2*x3 + 2*x1*x2^2*x4 - x1*x2*x3^2 - 3*x1*x2*x4^2 - x1*x2*x5^2 - x2^3*x3 + 2*x2^2*x3*x4) + 2*x0^2*x4*(2*s0 - 2*s2) + 2*x0^2*x2*(s2 - 2*s0 + s3) + 2*x0*(2*x1*x4 - x2*x3)*(s1 - 2*s0 + s2) - 2*x0*x1*x2*(s1 - 2*s0 + s3), (2*s0 - 2*s1)*(2*x5*x1^2 + 2*x5*x2^2) - 2*x0*(2*x5*x0^2*x1 - 4*x5*x0*x1^2 - 2*x5*x0*x2^2 + 2*x4*x5*x0*x2 + 2*x5*x1^3 + 2*x5*x1*x2^2 - 2*x4*x5*x1*x2 + 2*x3*x5*x2^2) + 2*x0^2*x5*(2*s0 - 2*s2) + 4*x0*x1*x5*(s1 - 2*s0 + s2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2*x1^3*x4^2 + 2*x2^2*x3^3 + 2*x1^3*x5^2 + (s0 - s2)*(2*x1*x4^2 - 2*x2*x3*x4 + 2*x1*x5^2) - 2*x0*(x1^2*x4^2 + x1^2*x5^2 - 2*x1*x2*x3*x4 + x2^2*x3^2 + x2^2*x5^2) - 2*x1*x2*x4^3 - 2*x2^3*x3*x4 - 2*x2*(s0 - s3)*(x1*x4 - x2*x3) - 2*x0*x1^2*x4^2 - 2*x0*x2^2*x3^2 - 2*x0*x1^2*x5^2 - 2*x0*x2^2*x5^2 + 2*x1*x2^2*x4^2 + 2*x1*x2^2*x5^2 + 2*x2^2*x3*x4^2 + 2*x2^2*x3*x5^2 - 2*x1*x2*x3^2*x4 - 2*x1^2*x2*x3*x4 - 2*x1*x2*x4*x5^2 + 4*x0*x1*x2*x3*x4,                                                                    2*x0*(x4^2 + x5^2)*(s0 - s2) - (2*s0 - 2*s1)*(2*x1*x4^2 - 2*x2*x3*x4 + 2*x1*x5^2) - 2*x0*(- 3*x1^2*x4^2 - 3*x1^2*x5^2 + 2*x1*x2*x3*x4 + 2*x0*x1*x4^2 + 2*x0*x1*x5^2 - x2^2*x4^2 - x2^2*x5^2 + x2*x3^2*x4 - 2*x0*x2*x3*x4 + x2*x4^3 + x2*x4*x5^2) - 2*x0*x2*x4*(s0 - s3),                                                                                                                                                                                              - (s0 - s3)*(2*x0*(x1*x4 - x2*x3) - 2*x0*x2*x3) - 2*x0*(x1^2*x3*x4 - 2*x1*x2*x4^2 - 2*x1*x2*x5^2 + x1*x3^2*x4 - 2*x0*x1*x3*x4 + x1*x4^3 + x1*x4*x5^2 + 3*x2^2*x3*x4 - 2*x2*x3^3 + 2*x0*x2*x3^2 - 2*x2*x3*x4^2 - 2*x2*x3*x5^2 + 2*x0*x2*x5^2) - (2*s0 - 2*s1)*(2*x2*x3^2 - 2*x1*x4*x3 + 2*x2*x5^2) - 2*x0*x3*x4*(s0 - s2),                                                      2*x0*(- x1^2*x2*x4 - 2*x1*x2*x3*x4 + 2*x0*x1*x2*x4 - x2^3*x4 + 3*x2^2*x3^2 - 2*x0*x2^2*x3 + x2^2*x4^2 + x2^2*x5^2) - (2*s0 - 2*s1)*(2*x3*x2^2 - 2*x1*x4*x2) + 2*x0*x2^2*(s0 - s3) - 2*x0*x2*x4*(s0 - s2),                                                                                                                                                                                              2*x0*(s0 - s2)*(2*x1*x4 - x2*x3) - 2*x0*(- 2*x1^3*x4 + x1^2*x2*x3 + 2*x0*x1^2*x4 - 2*x1*x2^2*x4 + x1*x2*x3^2 - 2*x0*x1*x2*x3 + 3*x1*x2*x4^2 + x1*x2*x5^2 + x2^3*x3 - 2*x2^2*x3*x4) - (2*s0 - 2*s1)*(2*x4*x1^2 - 2*x2*x3*x1) - 2*x0*x1*x2*(s0 - s3),                                                                 2*x0*(2*x1^3*x5 - 2*x0*x1^2*x5 - 2*x0*x2^2*x5 + 2*x1*x2^2*x5 + 2*x2^2*x3*x5 - 2*x1*x2*x4*x5) - (2*s0 - 2*s1)*(2*x5*x1^2 + 2*x5*x2^2) + 4*x0*x1*x5*(s0 - s2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (s0 - s1)*(2*x1*x4^2 - 2*x2*x3*x4 + 2*x1*x5^2) + 2*x0^2*(x1*x4^2 - x2*x3*x4 + x1*x5^2) - 4*x0*(x1^2*x4^2 + x1^2*x5^2 - x0*x1*x4^2 - x0*x1*x5^2 + x2^2*x4^2 + x2^2*x5^2 - x2*x3^2*x4 + x0*x2*x3*x4 - x2*x4^3 - x2*x4*x5^2) - 2*x0*(2*s0 - 2*s2)*(x4^2 + x5^2) + 4*x0*x2*x4*(s0 - s3),                                                                                                                                                                                                                                                          2*x0^2*(x0*x4^2 + x0*x5^2 - 2*x1*x4^2 - 2*x1*x5^2) + 2*x0*(x4^2 + x5^2)*(s0 - s1),                                                                                                                                                                                                                                                                                                                                                                                                   2*x0^2*x4*(s0 - s3) - 2*x0^2*(- x3^2*x4 + x0*x3*x4 - x4^3 + 2*x2*x4^2 - x4*x5^2 + 2*x2*x5^2) - 2*x0*x3*x4*(s0 - s1),                                                                                                                                                                                                       - 2*x0^2*(x0*x2*x4 - 2*x2*x3*x4) - 2*x0*x2*x4*(s0 - s1),                                                                                                                                                                                                                                                                     2*x0^2*(- 2*x1^2*x4 + 2*x0*x1*x4 - 2*x2^2*x4 + x2*x3^2 - x0*x2*x3 + 3*x2*x4^2 + x2*x5^2) + 2*x0^2*x2*(s0 - s3) + 2*x0*(s0 - s1)*(2*x1*x4 - x2*x3) - 2*x0^2*x4*(2*s0 - 2*s2),                                                                                                                   4*x0*x1*x5*(s0 - s1) - 2*x0^2*x5*(2*s0 - 2*s2) - 2*x0^2*(2*x5*x1^2 - 2*x0*x5*x1 + 2*x5*x2^2 - 2*x4*x5*x2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4*x0*x2*x4*(s0 - s2) - 4*x0*x2*(- x1^2*x4 + x0*x1*x4 - x2^2*x4 + x2*x3^2 - x0*x2*x3 + x2*x4^2 + x2*x5^2) - 2*x0^2*x2*(x1*x4 - x2*x3) - 2*x0*x2^2*(2*s0 - 2*s3) - 2*x2*(s0 - s1)*(x1*x4 - x2*x3),                                                                                                                                                                                                                                                                                       - 2*x0^2*x2*(x0*x4 - 2*x1*x4) - 2*x0*x2*x4*(s0 - s1),                                                                                                                                                                                                                                                                                   2*x0^2*x4*(s0 - s2) - 2*x0^2*(- x1^2*x4 + x0*x1*x4 - x2^2*x4 + x2*x3^2 - x0*x2*x3 + x2*x4^2 + x2*x5^2) - 2*x0^2*x2*(x3^2 - x0*x3 + x4^2 - 2*x2*x4 + x5^2) - (s0 - s1)*(2*x0*(x1*x4 - x2*x3) - 2*x0*x2*x3) - 2*x0^2*x2*(2*s0 - 2*s3),                                                                                                                                                                                                             2*x0*x2^2*(s0 - s1) + 2*x0^2*x2*(x0*x2 - 2*x2*x3),                                                                                                                                                                                                                                                                                                                                                        2*x0^2*x2*(s0 - s2) - 2*x0^2*x2*(- x1^2 + x0*x1 - x2^2 + 2*x4*x2) - 2*x0*x1*x2*(s0 - s1),                                                                                                                                                                                                             -4*x0^2*x2^2*x5];
 

end